cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
mod_c1_after
mod_c0_after
mink_c1_after
mink_c0_after
dt[c == 1, c("f1", "f2")]
probe - dt[c == 1, c("f1", "f2")]
probe
dt[c == 1, c("f1", "f2")]
dt[c == 1, c("f1", "f2")][1, ]
x <- dt[c == 1, c("f1", "f2")][1, ]
nrow(dt)
i <- 1
ex <- dt[c == 1, c("f1", "f2")][i, ]
ex
probe - ex
abs(probe - ex)
abs(probe - ex)^2
w*abs(probe - ex)^2
w
w <- c(1, 0)
w*abs(probe - ex)^2
sum( w*abs(probe - ex)^2 )^(1/2)
sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
})
sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c1_after <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c1_after
library(data.table)
library(ggplot2)
library(fields)
theme_set(new = theme_bw())
n <- 20
set.seed(437)
dt <- data.table(id = 1:n,
c = rep(c(1, 0), each = n),
f1 = runif(n, 1, 2))
dt[, f2 := f1 + rnorm(n, 0, 0.3)]
dt[, cor(f1, f2)]
dt[c == 0, c("f1", "f2") := list(f1 + 0.6, f2)]
probe <- data.table(f1 = 1.75, f2 = 1.25)
w <- c(0.5, 0.5)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
mod_c1_after
mod_c0_after
mink_c1_after
mink_c0_after
mod_c1_before
mod_c0_before
mink_c1_before
mink_c0_before
means
library(data.table)
library(ggplot2)
library(fields)
theme_set(new = theme_bw())
n <- 20
set.seed(437)
dt <- data.table(id = 1:n,
c = rep(c(1, 0), each = n),
f1 = runif(n, 1, 2))
dt[, f2 := f1 + rnorm(n, 0, 0.3)]
dt[, cor(f1, f2)]
dt[c == 0, c("f1", "f2") := list(f1 + 0.6, f2)]
probe <- data.table(f1 = 1.75, f2 = 1.25)
w <- c(0.5, 0.5)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c1_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c0_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
mod_c1_no_w
mod_c0_no_w
mod_c0_after
mod_c1_after
w1 <- seq(0, 1, .5)
c(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
sapply(w1, function(z) {
w <- c(z, 1-z)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c1_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c1_no_w <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c0_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c0_no_w <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
c(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
})
n <- 20
w1 <- seq(0, 1, .5)
sapply(w1, function(z) {
w <- c(z, 1-z)
set.seed(437)
dt <- data.table(id = 1:n,
c = rep(c(1, 0), each = n),
f1 = runif(n, 1, 2))
dt[, f2 := f1 + rnorm(n, 0, 0.3)]
dt[, cor(f1, f2)]
dt[c == 0, c("f1", "f2") := list(f1 + 0.6, f2)]
probe <- data.table(f1 = 1.75, f2 = 1.25)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c1_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c1_no_w <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c0_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c0_no_w <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
c(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
})
dt
w1 <- seq(0.01, 1, .5)
w1
w1 <- seq(0.01, 1, .3)
sapply(w1, function(z) {
w <- c(z, 1-z)
set.seed(437)
dt <- data.table(id = 1:n,
c = rep(c(1, 0), each = n),
f1 = runif(n, 1, 2))
dt[, f2 := f1 + rnorm(n, 0, 0.3)]
dt[, cor(f1, f2)]
dt[c == 0, c("f1", "f2") := list(f1 + 0.6, f2)]
probe <- data.table(f1 = 1.75, f2 = 1.25)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c1_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c1_no_w <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c0_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c0_no_w <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
c(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
})
res <- t(sapply(w1, function(z) {
w <- c(z, 1-z)
set.seed(437)
dt <- data.table(id = 1:n,
c = rep(c(1, 0), each = n),
f1 = runif(n, 1, 2))
dt[, f2 := f1 + rnorm(n, 0, 0.3)]
dt[, cor(f1, f2)]
dt[c == 0, c("f1", "f2") := list(f1 + 0.6, f2)]
probe <- data.table(f1 = 1.75, f2 = 1.25)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c1_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c1_no_w <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c0_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c0_no_w <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
c(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
}))
res
w1
rownames(res) <- w1
res
dt
as.string(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
as.character(mod_c1_no_w, mod_c1_before, mod_c1_after, mod_c0_no_w, mod_c0_before, mod_c0_after,
mink_c1_no_w, mink_c1_before, mink_c1_after, mink_c0_no_w, mink_c0_before, mink_c0_after)
colnames(res) <- c("mod_c1_no_w", "mod_c1_before", "mod_c1_after", "mod_c0_no_w", "mod_c0_before", "mod_c0_after",
"mink_c1_no_w", "mink_c1_before", "mink_c1_after", "mink_c0_no_w", "mink_c0_before", "mink_c0_after")
res
w1 <- seq(0.01, .99, .01)
w1
res <- t(sapply(w1, function(z) {
w <- c(z, 1-z)
set.seed(437)
dt <- data.table(id = 1:n,
c = rep(c(1, 0), each = n),
f1 = runif(n, 1, 2))
dt[, f2 := f1 + rnorm(n, 0, 0.3)]
dt[, cor(f1, f2)]
dt[c == 0, c("f1", "f2") := list(f1 + 0.6, f2)]
probe <- data.table(f1 = 1.75, f2 = 1.25)
# Applying w at the end
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c1_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c1_after <- sum(sapply(1:nrow(dt[c == 1, ]), function(i) {
ex <- dt[c == 1, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c1_no_w <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_after <- sum(sapply(1:2, function(i) {
w[i] * sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mod_c0_no_w <- sqrt(mahalanobis(as.vector(probe), center = means, cov = cov))
mink_c0_after <- sum(sapply(1:nrow(dt[c == 0, ]), function(i) {
ex <- dt[c == 0, c("f1", "f2")][i, ]
sum( w*abs(probe - ex)^2 )^(1/2)
}))
mink_c0_no_w <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
# Applying w at the beginning
dt[, f1 := f1 * w[1]]
dt[, f2 := f2 * w[2]]
# Category 1
cov <- var(as.data.frame(dt[c == 1])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 1, .(mean(f1), mean(f2))]))
mod_c1_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
# Category 0
cov <- var(as.data.frame(dt[c == 0])[ , grepl("^f", colnames(dt))])
means <- unlist(c(dt[c == 0, .(mean(f1), mean(f2))]))
mod_c0_before <- sum(sapply(1:2, function(i) {
sqrt(mahalanobis(as.vector(probe[, ..i]), center = means[i], cov = cov[i, i]))
}))
mink_c1_before <- sum(rdist(probe, dt[c == 1, c("f1", "f2")]))
mink_c0_before <- sum(rdist(probe, dt[c == 0, c("f1", "f2")]))
c(mod_c1_no_w, mod_c0_no_w, mod_c1_before, mod_c0_before, mod_c1_after, mod_c0_after,
mink_c1_no_w, mink_c0_no_w, mink_c1_before, mink_c0_before, mink_c1_after, mink_c0_after)
}))
res
rownames(res) <- w1
colnames(res) <- c("mod_c1_no_w", "mod_c0_no_w", "mod_c1_before", "mod_c0_before", "mod_c1_after", "mod_c0_after",
"mink_c1_no_w", "mink_c0_no_w", "mink_c1_before", "mink_c0_before", "mink_c1_after", "mink_c0_after")
res
res[, 1] > res[, 2]
res[, 7]
res[, 1] > res[, 2] != res[, 7] < res[, 8]
(res[, 1] > res[, 2]) != (res[, 7] < res[, 8])
unique((res[, 1] > res[, 2]) != (res[, 7] < res[, 8]))
(res[, 3] > res[, 4]) != (res[, 9] < res[, 10])
unique((res[, 3] > res[, 4]) != (res[, 9] < res[, 10]))
unique((res[, 5] > res[, 6]) != (res[, 11] < res[, 12]))
(res[, 5] > res[, 6]) != (res[, 11] < res[, 12])
var
self
f = self$input
c = self$cat
c
cumsum(c)
cumsum(c == 0)
self$formula
self$stimulus_frequencies
cumsum(c == 0)
n_c <- cbind(cumsum(c == 0), cumsum(c == 1))
n_c
((n-1)/n) * var(f[c == 0, ])
f
prev_f <- f[1:i, ]
i
prev_f <- f[1:i, , drop = FALSE]
prev_f
prev_c <- c[1:i]
prev_c
((n_c[i, 1]-1)/n_c[i, 1]) * var(prev_f[prev_c == 0, ])
((n_c[i, 2]-1)/n_c[i, 2]) * var(prev_f[prev_c == 1, ])
cov_0 <- ((n_c[i, 1]-1)/n_c[i, 1]) * var(prev_f[prev_c == 0, ])
cov_1 <- ((n_c[i, 2]-1)/n_c[i, 2]) * var(prev_f[prev_c == 1, ])
lapply(1:nrow(f), function(i) {
prev_f <- f[1:i, , drop = FALSE]
prev_c <- c[1:i]
cov_cat_0 <- ((n_c[i, 1]-1)/n_c[i, 1]) * var(prev_f[prev_c == 0, ])
cov_cat_1 <- ((n_c[i, 2]-1)/n_c[i, 2]) * var(prev_f[prev_c == 1, ])
return(list(cov_cat_0, cov_cat_1))
})
identical <- FALSE
y <- as.data.frame(unique(y))
x = rbind(self$input, input)
y = self$input
x <- as.data.frame(unique(x))
rownames(x) <- apply(x, 1, paste0, collapse = "")
identical <- FALSE
y <- as.data.frame(unique(y))
rownames(y) <- apply(unique(y), 1, paste0, collapse = "")
pairs <- rbind(rep(1:nrow(x), each = nrow(y)), rep(1:nrow(y), times = nrow(x)))
sim_mat <- matrix(0, nrow = nrow(x), ncol = nrow(y))
pair <- 1
z <- pairs[, pair]
z
pairs
library("ltm")
install.packages("ltm")
library("metafor")
install.packages("metafor")
